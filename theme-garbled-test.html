<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸»é¡Œäº‚ç¢¼ä¿®å¾©æ¸¬è©¦</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .test-container {
            max-width: 1000px;
            margin: 20px auto;
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }
        .test-header {
            text-align: center;
            margin-bottom: 30px;
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
        }
        .test-button {
            background: linear-gradient(135deg, #22c55e, #16a34a);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px;
            transition: all 0.2s;
        }
        .test-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(34, 197, 94, 0.3);
        }
        .test-result {
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            border-left: 4px solid #22c55e;
            background: #f0fdf4;
        }
        .test-result.error {
            border-left-color: #ef4444;
            background: #fef2f2;
        }
        .test-result.info {
            border-left-color: #3b82f6;
            background: #f0f9ff;
        }
        .test-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 10px;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            margin: 10px 0;
        }
        .test-icon {
            font-size: 24px;
        }
        .test-text {
            font-size: 16px;
        }
        .theme-preview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .theme-card {
            padding: 15px;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        .theme-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        .theme-icon {
            font-size: 32px;
            margin-bottom: 10px;
        }
        .theme-name {
            font-weight: 600;
            margin-bottom: 5px;
        }
        .theme-id {
            font-size: 12px;
            color: #6b7280;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="test-header">
            <h1>ğŸ”§ ä¸»é¡Œäº‚ç¢¼ä¿®å¾©æ¸¬è©¦</h1>
            <p>æª¢æŸ¥æ‰€æœ‰ä¸»é¡Œçš„ä¸­æ–‡å­—ç¬¦é¡¯ç¤ºæ˜¯å¦æ­£å¸¸</p>
        </div>
        
        <div class="test-section">
            <h2>CSS å…§å®¹å±¬æ€§æ¸¬è©¦</h2>
            <button class="test-button" onclick="testCssContent()">æ¸¬è©¦CSSå…§å®¹å±¬æ€§</button>
            <div id="cssTestResults"></div>
            
            <div class="test-item">
                <div class="test-icon">ğŸ”</div>
                <div class="test-text">å¿«é€Ÿé¸æ“‡æ¸¬è©¦ï¼š<span class="quick-title">é€™è£¡æ‡‰è©²é¡¯ç¤º ğŸ” æˆ–å¿«é€Ÿé¸æ“‡ï¼š</span></div>
            </div>
            
            <div class="test-item">
                <div class="test-icon">ğŸ“Š</div>
                <div class="test-text">ä»£ç¢¼æ¬„ä½æ¸¬è©¦ï¼š<span class="form-label" style="display: flex; align-items: center;">è‚¡ç¥¨ä»£ç¢¼</span></div>
            </div>
            
            <div class="test-item">
                <div class="test-icon">ğŸ“ˆ</div>
                <div class="test-text">è‚¡ç¥¨åç¨±æ¸¬è©¦ï¼š<span class="form-label" style="display: flex; align-items: center;">è‚¡ç¥¨åç¨±</span></div>
            </div>
            
            <div class="test-item">
                <div class="test-icon">ğŸ“…</div>
                <div class="test-text">æ—¥æœŸæ¬„ä½æ¸¬è©¦ï¼š<span class="form-label" style="display: flex; align-items: center;">æ—¥æœŸ</span></div>
            </div>
            
            <div class="test-item">
                <div class="test-icon">ğŸ’°</div>
                <div class="test-text">åƒ¹æ ¼æ¬„ä½æ¸¬è©¦ï¼š<span class="form-label" style="display: flex; align-items: center;">åƒ¹æ ¼</span></div>
            </div>
            
            <div class="test-item">
                <div class="test-icon">ğŸ”™</div>
                <div class="test-text">è¿”å›æŒ‰éˆ•æ¸¬è©¦ï¼š<button class="investment-back-btn" style="position: relative; padding: 8px 16px; background: #f3f4f6; border: 1px solid #d1d5db; border-radius: 6px;">è¿”å›</button></div>
            </div>
        </div>
        
        <div class="test-section">
            <h2>ä¸»é¡Œåç¨±é¡¯ç¤ºæ¸¬è©¦</h2>
            <button class="test-button" onclick="testThemeNames()">æ¸¬è©¦ä¸»é¡Œåç¨±</button>
            <div id="themeTestResults"></div>
            <div class="theme-preview" id="themePreview"></div>
        </div>
        
        <div class="test-section">
            <h2>æ°´æœä¸»é¡Œåœ–æ¨™æ¸¬è©¦</h2>
            <button class="test-button" onclick="testFruitTheme()">æ¸¬è©¦æ°´æœä¸»é¡Œ</button>
            <div id="fruitTestResults"></div>
            <div style="margin-top: 20px;">
                <div class="card" style="position: relative; padding: 20px; border: 1px solid #e5e7eb; border-radius: 8px;">
                    <h4>æ™®é€šå¡ç‰‡</h4>
                    <p>é€™æ˜¯ä¸€å€‹æ¸¬è©¦å¡ç‰‡ï¼Œåœ¨æ°´æœä¸»é¡Œä¸‹æ‡‰è©²é¡¯ç¤ºæ°´æœåœ–æ¨™</p>
                </div>
                <div class="investment-card" style="position: relative; padding: 20px; border: 1px solid #e5e7eb; border-radius: 8px; margin-top: 10px;">
                    <h4>æŠ•è³‡å¡ç‰‡</h4>
                    <p>é€™æ˜¯ä¸€å€‹æŠ•è³‡å¡ç‰‡ï¼Œåœ¨æ°´æœä¸»é¡Œä¸‹æ‡‰è©²é¡¯ç¤ºğŸŠåœ–æ¨™</p>
                </div>
                <div class="budget-card" style="position: relative; padding: 20px; border: 1px solid #e5e7eb; border-radius: 8px; margin-top: 10px;">
                    <h4>é ç®—å¡ç‰‡</h4>
                    <p>é€™æ˜¯ä¸€å€‹é ç®—å¡ç‰‡ï¼Œåœ¨æ°´æœä¸»é¡Œä¸‹æ‡‰è©²é¡¯ç¤ºğŸ‹åœ–æ¨™</p>
                </div>
                <div class="wallet-card" style="position: relative; padding: 20px; border: 1px solid #e5e7eb; border-radius: 8px; margin-top: 10px;">
                    <h4>éŒ¢åŒ…å¡ç‰‡</h4>
                    <p>é€™æ˜¯ä¸€å€‹éŒ¢åŒ…å¡ç‰‡ï¼Œåœ¨æ°´æœä¸»é¡Œä¸‹æ‡‰è©²é¡¯ç¤ºğŸ‡åœ–æ¨™</p>
                </div>
                <div class="chart-card" style="position: relative; padding: 20px; border: 1px solid #e5e7eb; border-radius: 8px; margin-top: 10px;">
                    <h4>åœ–è¡¨å¡ç‰‡</h4>
                    <p>é€™æ˜¯ä¸€å€‹åœ–è¡¨å¡ç‰‡ï¼Œåœ¨æ°´æœä¸»é¡Œä¸‹æ‡‰è©²é¡¯ç¤ºğŸ’åœ–æ¨™</p>
                </div>
            </div>
        </div>
        
        <div class="test-section">
            <h2>ç¿¡ç¿ ç‹å­ä¸»é¡Œæ¸¬è©¦</h2>
            <button class="test-button" onclick="testEmeraldPrinceTheme()">æ¸¬è©¦ç¿¡ç¿ ç‹å­ä¸»é¡Œ</button>
            <div id="emeraldTestResults"></div>
            <div class="komori-dialog" style="position: relative; padding: 20px; border: 1px solid #e5e7eb; border-radius: 8px; margin-top: 10px;">
                <h4>Komori å°è©±æ¡†</h4>
                <p>é€™æ˜¯ä¸€å€‹æ¸¬è©¦å°è©±æ¡†ï¼Œåœ¨ç¿¡ç¿ ç‹å­ä¸»é¡Œä¸‹æ‡‰è©²é¡¯ç¤ºğŸ‘‘åœ–æ¨™</p>
            </div>
        </div>
        
        <div class="test-section">
            <h2>ç·¨ç¢¼æª¢æ¸¬</h2>
            <button class="test-button" onclick="testEncoding()">æª¢æ¸¬æ–‡ä»¶ç·¨ç¢¼</button>
            <div id="encodingTestResults"></div>
        </div>
    </div>

    <script src="js/theme.js"></script>
    
    <script>
        // é¡¯ç¤ºæ¸¬è©¦çµæœ
        function showTestResult(elementId, message, type = 'success') {
            const element = document.getElementById(elementId);
            const resultDiv = document.createElement('div');
            resultDiv.className = `test-result ${type}`;
            resultDiv.innerHTML = message;
            element.appendChild(resultDiv);
        }
        
        // æ¸…é™¤æ¸¬è©¦çµæœ
        function clearTestResults(elementId) {
            document.getElementById(elementId).innerHTML = '';
        }
        
        // æ¸¬è©¦CSSå…§å®¹å±¬æ€§
        function testCssContent() {
            clearTestResults('cssTestResults');
            
            const tests = [
                { selector: '.quick-title::before', expected: 'ğŸ” æˆ–å¿«é€Ÿé¸æ“‡ï¼š', description: 'å¿«é€Ÿé¸æ“‡åœ–æ¨™' },
                { selector: '.form-field:has(#calcStockCodeInput) .form-label::before', expected: 'ğŸ“Š', description: 'ä»£ç¢¼æ¬„ä½åœ–æ¨™' },
                { selector: '.form-field:has(#calcStockNameInput) .form-label::before', expected: 'ğŸ“ˆ', description: 'è‚¡ç¥¨åç¨±åœ–æ¨™' },
                { selector: '.form-field:has(#calcDateInput) .form-label::before', expected: 'ğŸ“…', description: 'æ—¥æœŸæ¬„ä½åœ–æ¨™' },
                { selector: '.form-field:has(#calcPriceInput) .form-label::before', expected: 'ğŸ’°', description: 'åƒ¹æ ¼æ¬„ä½åœ–æ¨™' },
                { selector: '.form-field:has(#calcSharesInput) .form-label::before', expected: 'ğŸ“Š', description: 'è‚¡æ•¸æ¬„ä½åœ–æ¨™' },
                { selector: '.investment-back-btn::before', expected: 'ğŸ”™', description: 'è¿”å›æŒ‰éˆ•åœ–æ¨™' },
                { selector: '.input-field-label::before', expected: 'ğŸ“', description: 'è¼¸å…¥æ¬„ä½åœ–æ¨™' }
            ];
            
            let passedTests = 0;
            let totalTests = tests.length;
            
            tests.forEach(test => {
                try {
                    const element = document.querySelector(test.selector);
                    if (element) {
                        const styles = window.getComputedStyle(element, '::before');
                        const content = styles.getPropertyValue('content').replace(/['"]/g, '');
                        
                        if (content === test.expected) {
                            showTestResult('cssTestResults', `âœ… ${test.description}: æ­£ç¢ºé¡¯ç¤º "${content}"`, 'success');
                            passedTests++;
                        } else {
                            showTestResult('cssTestResults', `âŒ ${test.description}: æœŸæœ› "${test.expected}"ï¼Œå¯¦éš› "${content}"`, 'error');
                        }
                    } else {
                        showTestResult('cssTestResults', `âš ï¸ ${test.description}: æ‰¾ä¸åˆ°å…ƒç´ `, 'info');
                    }
                } catch (error) {
                    showTestResult('cssTestResults', `âŒ ${test.description}: æ¸¬è©¦å¤±æ•— - ${error.message}`, 'error');
                }
            });
            
            showTestResult('cssTestResults', `ğŸ¯ CSSå…§å®¹å±¬æ€§æ¸¬è©¦å®Œæˆ: ${passedTests}/${totalTests} é€šé`, passedTests === totalTests ? 'success' : 'error');
        }
        
        // æ¸¬è©¦ä¸»é¡Œåç¨±
        function testThemeNames() {
            clearTestResults('themeTestResults');
            const preview = document.getElementById('themePreview');
            preview.innerHTML = '';
            
            if (typeof themes !== 'undefined' && Array.isArray(themes)) {
                const chineseThemes = themes.filter(theme => /[\u4e00-\u9fff]/.test(theme.name));
                
                if (chineseThemes.length > 0) {
                    showTestResult('themeTestResults', `ğŸ“Š æ‰¾åˆ° ${chineseThemes.length} å€‹ä¸­æ–‡ä¸»é¡Œ`, 'info');
                    
                    chineseThemes.forEach(theme => {
                        const card = document.createElement('div');
                        card.className = 'theme-card';
                        card.innerHTML = `
                            <div class="theme-icon">${theme.icon}</div>
                            <div class="theme-name">${theme.name}</div>
                            <div class="theme-id">${theme.id}</div>
                        `;
                        preview.appendChild(card);
                        
                        // æª¢æŸ¥æ˜¯å¦æœ‰äº‚ç¢¼
                        if (theme.name.includes('??') || theme.name.includes('')) {
                            showTestResult('themeTestResults', `âŒ ä¸»é¡Œ "${theme.id}" åç¨±åŒ…å«äº‚ç¢¼: "${theme.name}"`, 'error');
                        } else {
                            showTestResult('themeTestResults', `âœ… ä¸»é¡Œ "${theme.id}" åç¨±æ­£å¸¸: "${theme.name}"`, 'success');
                        }
                    });
                } else {
                    showTestResult('themeTestResults', 'âš ï¸ æ²’æœ‰æ‰¾åˆ°ä¸­æ–‡ä¸»é¡Œ', 'info');
                }
            } else {
                showTestResult('themeTestResults', 'âŒ ç„¡æ³•è¼‰å…¥ä¸»é¡Œæ•¸æ“š', 'error');
            }
        }
        
        // æ¸¬è©¦æ°´æœä¸»é¡Œ
        function testFruitTheme() {
            clearTestResults('fruitTestResults');
            
            // åˆ‡æ›åˆ°æ°´æœä¸»é¡Œ
            document.documentElement.setAttribute('data-theme', 'fruit');
            
            setTimeout(() => {
                const tests = [
                    { selector: '.card::after', expected: 'ğŸ“', description: 'æ™®é€šå¡ç‰‡æ°´æœåœ–æ¨™' },
                    { selector: '.investment-card::after', expected: 'ğŸŠ', description: 'æŠ•è³‡å¡ç‰‡æ°´æœåœ–æ¨™' },
                    { selector: '.budget-card::after', expected: 'ğŸ‹', description: 'é ç®—å¡ç‰‡æ°´æœåœ–æ¨™' },
                    { selector: '.wallet-card::after', expected: 'ğŸ‡', description: 'éŒ¢åŒ…å¡ç‰‡æ°´æœåœ–æ¨™' },
                    { selector: '.chart-card::after', expected: 'ğŸ’', description: 'åœ–è¡¨å¡ç‰‡æ°´æœåœ–æ¨™' }
                ];
                
                let passedTests = 0;
                let totalTests = tests.length;
                
                tests.forEach(test => {
                    try {
                        const element = document.querySelector(test.selector);
                        if (element) {
                            const styles = window.getComputedStyle(element, '::after');
                            const content = styles.getPropertyValue('content').replace(/['"]/g, '');
                            
                            if (content === test.expected) {
                                showTestResult('fruitTestResults', `âœ… ${test.description}: æ­£ç¢ºé¡¯ç¤º "${content}"`, 'success');
                                passedTests++;
                            } else {
                                showTestResult('fruitTestResults', `âŒ ${test.description}: æœŸæœ› "${test.expected}"ï¼Œå¯¦éš› "${content}"`, 'error');
                            }
                        } else {
                            showTestResult('fruitTestResults', `âš ï¸ ${test.description}: æ‰¾ä¸åˆ°å…ƒç´ `, 'info');
                        }
                    } catch (error) {
                        showTestResult('fruitTestResults', `âŒ ${test.description}: æ¸¬è©¦å¤±æ•— - ${error.message}`, 'error');
                    }
                });
                
                showTestResult('fruitTestResults', `ğŸ“ æ°´æœä¸»é¡Œæ¸¬è©¦å®Œæˆ: ${passedTests}/${totalTests} é€šé`, passedTests === totalTests ? 'success' : 'error');
                
                // æ¢å¾©é»˜èªä¸»é¡Œ
                document.documentElement.removeAttribute('data-theme');
            }, 100);
        }
        
        // æ¸¬è©¦ç¿¡ç¿ ç‹å­ä¸»é¡Œ
        function testEmeraldPrinceTheme() {
            clearTestResults('emeraldTestResults');
            
            // åˆ‡æ›åˆ°ç¿¡ç¿ ç‹å­ä¸»é¡Œ
            document.documentElement.setAttribute('data-theme', 'emeraldPrince');
            
            setTimeout(() => {
                try {
                    const element = document.querySelector('.komori-dialog::before');
                    if (element) {
                        const styles = window.getComputedStyle(element, '::before');
                        const content = styles.getPropertyValue('content').replace(/['"]/g, '');
                        
                        if (content === 'ğŸ‘‘') {
                            showTestResult('emeraldTestResults', `âœ… ç¿¡ç¿ ç‹å­ä¸»é¡Œåœ–æ¨™: æ­£ç¢ºé¡¯ç¤º "${content}"`, 'success');
                        } else {
                            showTestResult('emeraldTestResults', `âŒ ç¿¡ç¿ ç‹å­ä¸»é¡Œåœ–æ¨™: æœŸæœ› "ğŸ‘‘"ï¼Œå¯¦éš› "${content}"`, 'error');
                        }
                    } else {
                        showTestResult('emeraldTestResults', `âš ï¸ æ‰¾ä¸åˆ° komori-dialog å…ƒç´ `, 'info');
                    }
                } catch (error) {
                    showTestResult('emeraldTestResults', `âŒ ç¿¡ç¿ ç‹å­ä¸»é¡Œæ¸¬è©¦å¤±æ•— - ${error.message}`, 'error');
                }
                
                // æ¢å¾©é»˜èªä¸»é¡Œ
                document.documentElement.removeAttribute('data-theme');
            }, 100);
        }
        
        // æ¸¬è©¦ç·¨ç¢¼
        function testEncoding() {
            clearTestResults('encodingTestResults');
            
            // æª¢æ¸¬é é¢ç·¨ç¢¼
            const pageEncoding = document.characterSet || document.charset;
            showTestResult('encodingTestResults', `ğŸ“„ é é¢ç·¨ç¢¼: ${pageEncoding}`, 'info');
            
            // æª¢æ¸¬å¸¸ç”¨ä¸­æ–‡å­—ç¬¦
            const testChars = ['ä¸»é¡Œ', 'è¨­å®š', 'åˆ†æ', 'æŠ•è³‡', 'é ç®—', 'å ±è¡¨', 'åœ–è¡¨', 'çµ±è¨ˆ'];
            const encodedChars = testChars.map(char => {
                const encoded = encodeURIComponent(char);
                return `${char} -> ${encoded}`;
            });
            
            showTestResult('encodingTestResults', `ğŸ”¤ ä¸­æ–‡å­—ç¬¦ç·¨ç¢¼æ¸¬è©¦:<br>${encodedChars.join('<br>')}`, 'info');
            
            // æª¢æ¸¬æ˜¯å¦æœ‰äº‚ç¢¼å­—ç¬¦
            const hasGarbled = document.body.innerText.includes('??') || document.body.innerText.includes('');
            if (hasGarbled) {
                showTestResult('encodingTestResults', 'âŒ æª¢æ¸¬åˆ°å¯èƒ½çš„äº‚ç¢¼å­—ç¬¦', 'error');
            } else {
                showTestResult('encodingTestResults', 'âœ… æ²’æœ‰æª¢æ¸¬åˆ°äº‚ç¢¼å­—ç¬¦', 'success');
            }
        }
        
        // é é¢è¼‰å…¥æ™‚è‡ªå‹•é‹è¡ŒåŸºæœ¬æ¸¬è©¦
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                showTestResult('cssTestResults', 'ğŸš€ é–‹å§‹è‡ªå‹•æ¸¬è©¦...', 'info');
                testCssContent();
                testThemeNames();
                testEncoding();
            }, 1000);
        });
    </script>
</body>
</html>
